var Tess2=function(t){"use strict";var i,s;function e(t,i){if(!t)throw i||"Assertion Failed!"}(i=t.t||(t.t={}))[i.i=0]="ODD",i[i.s=1]="NONZERO",i[i.h=2]="POSITIVE",i[i.l=3]="NEGATIVE",i[i.u=4]="ABS_GEQ_TWO",(s=t.o||(t.o={}))[s.v=0]="POLYGONS",s[s.g=1]="CONNECTED_POLYGONS",s[s.p=2]="BOUNDARY_CONTOURS";class r{static _(t,i){return t.m===i.m&&t.R===i.R}static D(t,i){return t.m<i.m||t.m===i.m&&t.R<=i.R}static M(t,i){return t.R<i.R||t.R===i.R&&t.m<=i.m}static k(t){return r.D(t.O,t.L)}static F(t){return r.D(t.L,t.O)}static N(t,i){return Math.abs(t.m-i.m)+Math.abs(t.R-i.R)}static S(t,i,s){e(r.D(t,i)&&r.D(i,s));var h=i.m-t.m,n=s.m-i.m;return h+n>0?h<n?i.R-t.R+(t.R-s.R)*(h/(h+n)):i.R-s.R+(s.R-t.R)*(n/(h+n)):0}static C(t,i,s){e(r.D(t,i)&&r.D(i,s));var h=i.m-t.m,n=s.m-i.m;return h+n>0?(i.R-s.R)*h+(i.R-t.R)*n:0}static I(t,i,s){e(r.M(t,i)&&r.M(i,s));var h=i.R-t.R,n=s.R-i.R;return h+n>0?h<n?i.m-t.m+(t.m-s.m)*(h/(h+n)):i.m-s.m+(s.m-t.m)*(n/(h+n)):0}static V(t,i,s){e(r.M(t,i)&&r.M(i,s));var h=i.R-t.R,n=s.R-i.R;return h+n>0?(i.m-s.m)*h+(i.m-t.m)*n:0}static A(t,i,s){return t.m*(i.R-s.R)+i.m*(s.R-t.R)+s.m*(t.R-i.R)>=0}static W(t,i,s,e){return(t=t<0?0:t)<=(s=s<0?0:s)?0===s?(i+e)/2:i+t/(t+s)*(e-i):e+s/(t+s)*(i-e)}static P(t,i,s,e,h){var n,l,a;r.D(t,i)||(a=t,t=i,i=a),r.D(s,e)||(a=s,s=e,e=a),r.D(t,s)||(a=t,t=s,s=a,a=i,i=e,e=a),r.D(s,i)?r.D(i,e)?((n=r.S(t,s,i))+(l=r.S(s,i,e))<0&&(n=-n,l=-l),h.m=r.W(n,s.m,l,i.m)):((n=r.C(t,s,i))+(l=-r.C(t,e,i))<0&&(n=-n,l=-l),h.m=r.W(n,s.m,l,e.m)):h.m=(s.m+i.m)/2,r.M(t,i)||(a=t,t=i,i=a),r.M(s,e)||(a=s,s=e,e=a),r.M(t,s)||(a=t,t=s,s=a,a=i,i=e,e=a),r.M(s,i)?r.M(i,e)?((n=r.I(t,s,i))+(l=r.I(s,i,e))<0&&(n=-n,l=-l),h.R=r.W(n,s.R,l,i.R)):((n=r.V(t,s,i))+(l=-r.V(t,e,i))<0&&(n=-n,l=-l),h.R=r.W(n,s.R,l,e.R)):h.R=(s.R+i.R)/2}}class h{constructor(){this.next=null,this.T=null,this.G=null,this.B=null,this.n=0,this.q=!1,this.U=!1}}class n{constructor(t){this.Y=t,this.next=null,this.L=null,this.Z=null,this.j=null,this.H=null,this.J=null,this.K=null,this.X=0}get $(){return this.Z.J}set $(t){this.Z.J=t}get O(){return this.Z.L}set O(t){this.Z.L=t}get tt(){return this.Z.H}set tt(t){this.Z.H=t}get it(){return this.j.Z}set it(t){this.j.Z=t}get st(){return this.H.Z}set st(t){this.H.Z=t}get et(){return this.Z.j}set et(t){this.Z.j=t}get rt(){return this.Z.j.Z}set rt(t){this.Z.j.Z=t}get ht(){return this.Z.H.Z}set ht(t){this.Z.H.Z=t}}class l{constructor(){this.next=null,this.T=null,this.G=null,this.coords=[0,0,0],this.m=0,this.R=0,this.nt=0,this.n=0,this.lt=0}}class a{constructor(){const t=new l,i=new h,s=new n(0),e=new n(1);t.next=t.T=t,t.G=null,i.next=i.T=i,s.next=s,s.Z=e,e.next=e,e.Z=s,this.at=t,this.ut=i,this.ot=s,this.ct=e}ft(t){var i=new n(0),s=new n(1);t.Z.Y<t.Y&&(t=t.Z);var e=t.Z.next;return s.next=e,e.Z.next=i,i.next=t,t.Z.next=s,i.Z=s,i.j=i,i.H=s,i.L=null,i.J=null,i.X=0,i.K=null,s.Z=i,s.j=s,s.H=i,s.L=null,s.J=null,s.X=0,s.K=null,i}vt(t,i){var s=t.j,e=i.j;s.Z.H=i,e.Z.H=t,t.j=e,i.j=s}dt(t,i,s){var r=t;e(r,"Vertex can't be null!");var h=s.T;r.T=h,h.next=r,r.next=s,s.T=r,r.G=i;var n=i;do{n.L=r,n=n.j}while(n!==i)}gt(t,i,s){var r=t;e(r,"Face can't be null");var h=s.T;r.T=h,h.next=r,r.next=s,s.T=r,r.G=i,r.B=null,r.q=!1,r.U=s.U;var n=i;do{n.J=r,n=n.H}while(n!==i)}wt(t){t.Z.Y<t.Y&&(t=t.Z);var i=t.next,s=t.Z.next;i.Z.next=s,s.Z.next=i}pt(t,i){var s=t.G,e=s;do{e.L=i,e=e.j}while(e!==s);var r=t.T,h=t.next;h.T=r,r.next=h}_t(t,i){var s=t.G,e=s;do{e.J=i,e=e.H}while(e!==s);var r=t.T,h=t.next;h.T=r,r.next=h}Et(){var t=new l,i=new l,s=new h,e=this.ft(this.ot);return this.dt(t,e,this.at),this.dt(i,e.Z,this.at),this.gt(s,e,this.ut),e}splice(t,i){var s=!1,e=!1;if(t!==i){if(i.L!==t.L&&(e=!0,this.pt(i.L,t.L)),i.J!==t.J&&(s=!0,this._t(i.J,t.J)),this.vt(i,t),!e){var r=new l;this.dt(r,i,t.L),t.L.G=t}if(!s){var n=new h;this.gt(n,i,t.J),t.J.G=t}}}delete(t){var i=t.Z,s=!1;if(t.J!==t.$&&(s=!0,this._t(t.J,t.$)),t.j===t)this.pt(t.L,null);else if(t.$.G=t.tt,t.L.G=t.j,this.vt(t,t.tt),!s){var e=new h;this.gt(e,t,t.J)}i.j===i?(this.pt(i.L,null),this._t(i.J,null)):(t.J.G=i.tt,i.L.G=i.j,this.vt(i,i.tt)),this.wt(t)}Rt(t){var i=this.ft(t),s=i.Z;this.vt(i,t.H),i.L=t.O;var e=new l;return this.dt(e,s,i.L),i.J=s.J=t.J,i}xt(t){var i=this.Rt(t).Z;return this.vt(t.Z,t.Z.tt),this.vt(t.Z,i),t.O=i.L,i.O.G=i.Z,i.$=t.$,i.X=t.X,i.Z.X=t.Z.X,i}connect(t,i){var s=!1,e=this.ft(t),r=e.Z;if(i.J!==t.J&&(s=!0,this._t(i.J,t.J)),this.vt(e,t.H),this.vt(r,i),e.L=t.O,r.L=i.L,e.J=r.J=t.J,t.J.G=r,!s){var n=new h;this.gt(n,e,t.J)}return e}Dt(t){var i,s,e,r,h,n=t.G;s=n.H;do{s=(i=s).H,i.J=null,null===i.$&&(i.j===i?this.pt(i.L,null):(i.L.G=i.j,this.vt(i,i.tt)),(e=i.Z).j===e?this.pt(e.L,null):(e.L.G=e.j,this.vt(e,e.tt)),this.wt(i))}while(i!=n);r=t.T,(h=t.next).T=r,r.next=h}Mt(t){var i=t.G,s=0;do{s++,i=i.H}while(i!==t.G);return s}kt(t){var i,s,e,h,n;for(i=this.ut.next;i!==this.ut;i=i.next)if(i.U)for(n=(s=i.G).L;e=s.H,(h=s.Z)&&h.J&&h.J.U&&this.Mt(i)+this.Mt(h.J)-2<=t&&r.A(s.it.L,s.L,h.H.H.L)&&r.A(h.it.L,h.L,s.H.H.L)&&(e=h.H,this.delete(h),s=null,h=null),!s||s.H.L!==n;)s=e;return!0}Ot(){var t,i,s,r,h,n,l=this.ut,a=this.at,u=this.ot;for(i=l,i=l;(t=i.next)!==l;i=t){e(t.T===i),h=t.G;do{e(h.Z!==h),e(h.Z.Z===h),e(h.H.j.Z===h),e(h.j.Z.H===h),e(h.J===t),h=h.H}while(h!==t.G)}for(e(t.T===i&&null===t.G),r=a,r=a;(s=r.next)!==a;r=s){e(s.T===r),h=s.G;do{e(h.Z!==h),e(h.Z.Z===h),e(h.H.j.Z===h),e(h.j.Z.H===h),e(h.L===s),h=h.j}while(h!==s.G)}for(e(s.T===r&&null===s.G),n=u,n=u;(h=n.next)!==u;n=h)e(h.Z.next===n.Z),e(h.Z!==h),e(h.Z.Z===h),e(null!==h.L),e(null!==h.O),e(h.H.j.Z===h),e(h.j.Z.H===h);e(h.Z.next===n.Z&&h.Z===this.ct&&h.Z.Z===h&&null===h.L&&null===h.O&&null===h.J&&null===h.$)}}class u{constructor(){this.Lt=null}}class o{constructor(){this.key=null,this.Ft=0}}class c{constructor(t,i){this.Nt=i,this.max=0,this.St=[],this.bt=[],this.yt=!1,this.Ct=0,this.size=0,this.max=t,this.St=Array.from({length:t+1},()=>new u),this.bt=Array.from({length:t+1},()=>new o),this.yt=!1,this.St[1].Lt=1,this.bt[1].key=null}It(t){var i,s,r,h=this.St,n=this.bt;for(i=h[t].Lt;;){if((r=t<<1)<this.size&&this.Nt(n[h[r+1].Lt].key,n[h[r].Lt].key)&&++r,e(r<=this.max),s=h[r].Lt,r>this.size||this.Nt(n[i].key,n[s].key)){h[t].Lt=i,n[i].Ft=t;break}h[t].Lt=s,n[s].Ft=t,t=r}}Vt(t){var i,s,e,r=this.St,h=this.bt;for(i=r[t].Lt;;){if(s=r[e=t>>1].Lt,0===e||this.Nt(h[s].key,h[i].key)){r[t].Lt=i,h[i].Ft=t;break}r[t].Lt=s,h[s].Ft=t,t=e}}init(){for(let t=this.size;t>=1;--t)this.It(t);this.yt=!0}min(){return this.bt[this.St[1].Lt].key}At(t){var i,s;if(2*(i=++this.size)>this.max){var e,r;for(this.max*=2,r=this.St.length,this.St.length=this.max+1,e=r;e<this.St.length;e++)this.St[e]=new u;for(r=this.bt.length,this.bt.length=this.max+1,e=r;e<this.bt.length;e++)this.bt[e]=new o}return 0===this.Ct?s=i:(s=this.Ct,this.Ct=this.bt[s].Ft),this.St[i].Lt=s,this.bt[s].Ft=i,this.bt[s].key=t,this.yt&&this.Vt(i),s}Wt(){var t=this.St,i=this.bt,s=t[1].Lt,e=i[s].key;return this.size>0&&(t[1].Lt=t[this.size].Lt,i[t[1].Lt].Ft=1,i[s].key=null,i[s].Ft=this.Ct,this.Ct=s,--this.size,this.size>0&&this.It(1)),e}delete(t){var i,s=this.St,r=this.bt;e(t>=1&&t<=this.max&&null!==r[t].key),s[i=r[t].Ft].Lt=s[this.size].Lt,r[s[i].Lt].Ft=i,--this.size,i<=this.size&&(i<=1||this.Nt(r[s[i>>1].Lt].key,r[s[i].Lt].key)?this.It(i):this.Vt(i)),r[t].key=null,r[t].Ft=this.Ct,this.Ct=t}}class f{constructor(){this.Pt=null,this.Tt=null,this.Gt=0,this.U=!1,this.zt=!1,this.Bt=!1,this.qt=!1}}class v{constructor(){this.key=null,this.next=null,this.T=null}}class d{constructor(t,i){this.frame=t,this.Nt=i,this.head=new v,this.head.next=this.head,this.head.T=this.head}min(){return this.head.next}max(){return this.head.T}At(t){return this.insertBefore(this.head,t)}search(t){let i=this.head;do{i=i.next}while(null!==i.key&&!this.Nt(this.frame,t,i.key));return i}insertBefore(t,i){do{t=t.T}while(null!==t.key&&!this.Nt(this.frame,t.key,i));const s=new v;return s.key=i,s.next=t.next,t.next.T=s,s.T=t,t.next=s,s}delete(t){t.next.T=t.T,t.T.next=t.next}}class g{static Ut(t){return t.Tt.T.key}static Qt(t){return t.Tt.next.key}static Yt(t){}static Zt(t,i){t.X+=i.X,t.Z.X+=i.Z.X}static jt(t,i,s){var e=t.event,h=i.Pt,n=s.Pt;if(h.O===e)return n.O===e?r.D(h.L,n.L)?r.C(n.O,h.L,n.L)<=0:r.C(h.O,n.L,h.L)>=0:r.C(n.O,e,n.L)<=0;if(n.O===e)return r.C(h.O,e,h.L)>=0;return r.S(h.O,e,h.L)>=r.S(n.O,e,n.L)}static Ht(t,i){i.qt&&e(0===i.Pt.X),i.Pt.K=null,t.Jt.delete(i.Tt)}static qt(t,i,s){e(i.qt),t.Kt.delete(i.Pt),i.qt=!1,i.Pt=s,s.K=i}static Xt(t,i){var s,e=i.Pt.L;do{i=g.Qt(i)}while(i.Pt.L===e);if(i.qt){if(null===(s=t.Kt.connect(g.Ut(i).Pt.Z,i.Pt.H)))return null;g.qt(t,i,s),i=g.Qt(i)}return i}static $t(t){var i=t.Pt.O;do{t=g.Qt(t)}while(t.Pt.O===i);return t}static ti(t,i,s){var e=new f;return e.Pt=s,e.Tt=t.Jt.insertBefore(i.Tt,e),e.qt=!1,e.zt=!1,e.Bt=!1,s.K=e,e}static ii(i,s){switch(i.si){case t.t.i:return 0!=(1&s);case t.t.s:return 0!==s;case t.t.h:return s>0;case t.t.l:return s<0;case t.t.u:return s>=2||s<=-2}throw new Error("Invalid winding rulle")}static ei(t,i){i.Gt=g.Qt(i).Gt+i.Pt.X,i.U=g.ii(t,i.Gt)}static ri(t,i){var s=i.Pt,e=s.J;e.U=i.U,e.G=s,g.Ht(t,i)}static hi(t,i,s){for(var e,r=null,h=i,n=i.Pt;h!==s;){if(h.qt=!1,(e=(r=g.Ut(h)).Pt).L!=n.L){if(!r.qt){g.ri(t,h);break}e=t.Kt.connect(n.it,e.Z),g.qt(t,r,e)}n.j!==e&&(t.Kt.splice(e.tt,e),t.Kt.splice(n,e)),g.ri(t,h),n=r.Pt,h=r}return n}static ni(t,i,s,h,n,l){var a,u,o,c,f=!0;o=s;do{e(r.D(o.L,o.O)),g.ti(t,i,o.Z),o=o.j}while(o!==h);for(null===n&&(n=g.Ut(i).Pt.et),u=i,c=n;(o=(a=g.Ut(u)).Pt.Z).L===c.L;)o.j!==c&&(t.Kt.splice(o.tt,o),t.Kt.splice(c.tt,o)),a.Gt=u.Gt-o.X,a.U=g.ii(t,a.Gt),u.Bt=!0,!f&&g.li(t,u)&&(g.Zt(o,c),g.Ht(t,u),t.Kt.delete(c)),f=!1,u=a,c=o;u.Bt=!0,e(u.Gt-o.X===a.Gt),l&&g.ai(t,u)}static ui(t,i,s){t.Kt.splice(i,s)}static oi(t,i,s){var e=r.N(i,t),h=r.N(s,t),n=.5*h/(e+h),l=.5*e/(e+h);t.coords[0]+=n*i.coords[0]+l*s.coords[0],t.coords[1]+=n*i.coords[1]+l*s.coords[1],t.coords[2]+=n*i.coords[2]+l*s.coords[2]}static ci(t,i,s,e,r,h){i.coords[0]=i.coords[1]=i.coords[2]=0,i.lt=-1,g.oi(i,s,e),g.oi(i,r,h)}static li(t,i){var s=g.Ut(i),e=i.Pt,h=s.Pt;if(r.D(e.L,h.L)){if(r.C(h.O,e.L,h.L)>0)return!1;r._(e.L,h.L)?e.L!==h.L&&(t.fi.delete(e.L.nt),g.ui(t,h.tt,e)):(t.Kt.xt(h.Z),t.Kt.splice(e,h.tt),i.Bt=s.Bt=!0)}else{if(r.C(e.O,h.L,e.L)<0)return!1;g.Qt(i).Bt=i.Bt=!0,t.Kt.xt(e.Z),t.Kt.splice(h.tt,e)}return!0}static vi(t,i){var s,h=g.Ut(i),n=i.Pt,l=h.Pt;if(e(!r._(n.O,l.O)),r.D(n.O,l.O)){if(r.C(n.O,l.O,n.L)<0)return!1;g.Qt(i).Bt=i.Bt=!0,s=t.Kt.xt(n),t.Kt.splice(l.Z,s),s.J.U=i.U}else{if(r.C(l.O,n.O,l.L)>0)return!1;i.Bt=h.Bt=!0,s=t.Kt.xt(l),t.Kt.splice(n.H,l.Z),s.$.U=i.U}return!0}static di(t,i){var s,h,n=g.Ut(i),a=i.Pt,u=n.Pt,o=a.L,c=u.L,f=a.O,v=u.O,d=new l;if(e(!r._(v,f)),e(r.C(f,t.event,o)<=0),e(r.C(v,t.event,c)>=0),e(o!==t.event&&c!==t.event),e(!i.qt&&!n.qt),o===c)return!1;if(Math.min(o.R,f.R)>Math.max(c.R,v.R))return!1;if(r.D(o,c)){if(r.C(v,o,c)>0)return!1}else if(r.C(f,c,o)<0)return!1;return g.Yt(t),r.P(f,o,v,c,d),e(Math.min(o.R,f.R)<=d.R),e(d.R<=Math.max(c.R,v.R)),e(Math.min(v.m,f.m)<=d.m),e(d.m<=Math.max(c.m,o.m)),r.D(d,t.event)&&(d.m=t.event.m,d.R=t.event.R),s=r.D(o,c)?o:c,r.D(s,d)&&(d.m=s.m,d.R=s.R),r._(d,o)||r._(d,c)?(g.li(t,i),!1):!r._(f,t.event)&&r.C(f,t.event,d)>=0||!r._(v,t.event)&&r.C(v,t.event,d)<=0?v===t.event?(t.Kt.xt(a.Z),t.Kt.splice(u.Z,a),i=g.Xt(t,i),a=g.Ut(i).Pt,g.hi(t,g.Ut(i),n),g.ni(t,i,a.tt,a,a,!0),!0):f===t.event?(t.Kt.xt(u.Z),t.Kt.splice(a.H,u.tt),n=i,i=g.$t(i),h=g.Ut(i).Pt.et,n.Pt=u.tt,u=g.hi(t,n,null),g.ni(t,i,u.j,a.et,h,!0),!0):(r.C(f,t.event,d)>=0&&(g.Qt(i).Bt=i.Bt=!0,t.Kt.xt(a.Z),a.L.m=t.event.m,a.L.R=t.event.R),r.C(v,t.event,d)<=0&&(i.Bt=n.Bt=!0,t.Kt.xt(u.Z),u.L.m=t.event.m,u.L.R=t.event.R),!1):(t.Kt.xt(a.Z),t.Kt.xt(u.Z),t.Kt.splice(u.tt,a),a.L.m=d.m,a.L.R=d.R,a.L.nt=t.fi.At(a.L),g.ci(t,a.L,o,f,c,v),g.Qt(i).Bt=i.Bt=n.Bt=!0,!1)}static ai(t,i){for(var s,e,r=g.Ut(i);;){for(;r.Bt;)i=r,r=g.Ut(r);if(!i.Bt&&(r=i,null===(i=g.Qt(i))||!i.Bt))return;if(i.Bt=!1,s=i.Pt,e=r.Pt,s.O!==e.O&&g.vi(t,i)&&(r.qt?(g.Ht(t,r),t.Kt.delete(e),e=(r=g.Ut(i)).Pt):i.qt&&(g.Ht(t,i),t.Kt.delete(s),s=(i=g.Qt(r)).Pt)),s.L!==e.L)if(s.O===e.O||i.qt||r.qt||s.O!==t.event&&e.O!==t.event)g.li(t,i);else if(g.di(t,i))return;s.L===e.L&&s.O===e.O&&(g.Zt(e,s),g.Ht(t,i),t.Kt.delete(s),i=g.Qt(r))}}static gi(t,i,s){var e,h=s.j,n=g.Ut(i),l=i.Pt,a=n.Pt,u=!1;l.O!==a.O&&g.di(t,i),r._(l.L,t.event)&&(t.Kt.splice(h.tt,l),i=g.Xt(t,i),h=g.Ut(i).Pt,g.hi(t,g.Ut(i),n),u=!0),r._(a.L,t.event)&&(t.Kt.splice(s,a.tt),s=g.hi(t,n,null),u=!0),u?g.ni(t,i,s.j,h,h,!0):(e=r.D(a.L,l.L)?a.tt:l,e=t.Kt.connect(s.it,e),g.ni(t,i,e,e.j,e.j,!1),e.Z.K.qt=!0,g.ai(t,i))}static wi(t,i,s){var h,n,l,a,u;return h=i.Pt,r._(h.L,s)?(e(!1),void g.ui(t,h,s.G)):r._(h.O,s)?(e(!1),i=g.$t(i),n=a=(l=(u=g.Ut(i)).Pt.Z).j,u.qt&&(e(n!==l),g.Ht(t,u),t.Kt.delete(l),l=n.tt),t.Kt.splice(s.G,l),r.k(n)||(n=null),void g.ni(t,i,l.j,a,n,!0)):(t.Kt.xt(h.Z),i.qt&&(t.Kt.delete(h.j),i.qt=!1),t.Kt.splice(s.G,h),void g.pi(t,s))}static _i(t,i){var s,e,h,n,l,a,u=new f;if(u.Pt=i.G.Z,s=t.Jt.search(u).key,e=g.Ut(s))if(n=s.Pt,l=e.Pt,0!==r.C(n.O,i,n.L))if(h=r.D(l.O,n.O)?s:e,s.U||h.qt){if(h===s)a=t.Kt.connect(i.G.Z,n.H);else a=t.Kt.connect(l.rt,i.G).Z;h.qt?g.qt(t,h,a):g.ei(t,g.ti(t,s,a)),g.pi(t,i)}else g.ni(t,s,i.G,i.G,null,!0);else g.wi(t,s,i)}static pi(t,i){t.event=i,g.Yt(t);for(var s=i.G;null===s.K;)if((s=s.j)===i.G)return void g._i(t,i);var r=g.Xt(t,s.K);e(null!==r);var h=g.Ut(r),n=h.Pt,l=g.hi(t,h,null);l.j===n?g.gi(t,r,l):g.ni(t,r,l.j,n,n,!0)}static Ei(t,i,s,e){var r=new f,h=t.Kt.Et();h.L.m=s,h.L.R=e,h.O.m=i,h.O.R=e,t.event=h.O,r.Pt=h,r.Gt=0,r.U=!1,r.qt=!1,r.zt=!0,r.Bt=!1,r.Tt=t.Jt.At(r)}static mi(t){t.Jt=new d(t,g.jt);var i=t.Ri[0]-t.xi[0],s=t.Ri[1]-t.xi[1],e=t.xi[0]-i,r=t.Ri[0]+i,h=t.xi[1]-s,n=t.Ri[1]+s;g.Ei(t,e,r,h),g.Ei(t,e,r,n)}static Di(t){for(var i,s=0;null!==(i=t.Jt.min().key);)i.zt||(e(i.qt),e(1==++s)),e(0===i.Gt),g.Ht(t,i)}static Mi(t){var i,s,e,h=t.Kt.ot;for(i=h.next;i!==h;i=s)s=i.next,e=i.H,r._(i.L,i.O)&&i.H.H!==i&&(g.ui(t,e,i),t.Kt.delete(i),e=(i=e).H),e.H===i&&(e!==i&&(e!==s&&e!==s.Z||(s=s.next),t.Kt.delete(e)),i!==s&&i!==s.Z||(s=s.next),t.Kt.delete(i))}static ki(t){var i,s,e,h=0;for(s=(e=t.Kt.at).next;s!==e;s=s.next)h++;for(h+=8,i=t.fi=new c(h,r.D),s=(e=t.Kt.at).next;s!==e;s=s.next)s.nt=i.At(s);return s===e&&(i.init(),!0)}static Oi(t){t.fi=null}static Li(t,i){var s,r,h;for(s=i.ut.next;s!==i.ut;s=r)r=s.next,e((h=s.G).H!==h),h.H.H===h&&(g.Zt(h.j,h),t.Kt.delete(h));return!0}static Fi(t,i=!0){var s,e;if(g.Mi(t),!g.ki(t))return!1;for(g.mi(t);null!==(s=t.fi.Wt());){for(;null!==(e=t.fi.min())&&r._(e,s);)e=t.fi.Wt(),g.ui(t,s.G,e.G);g.pi(t,s)}return t.event=t.Jt.min().key.Pt.L,g.Yt(t),g.Di(t),g.Oi(t),!!g.Li(t,t.Kt)&&(i&&t.Kt.Ot(),!0)}}class w{constructor(){this.Kt=new a,this.Ni=[0,0,0],this.Si=[0,0,0],this.bi=[0,0,0],this.xi=[0,0],this.Ri=[0,0],this.si=t.t.i,this.Jt=null,this.fi=null,this.event=null,this.yi=0,this.Ci=[],this.Ii=[],this.Vi=0,this.elements=[],this.Ai=0}Wi(t,i){return t[0]*i[0]+t[1]*i[1]+t[2]*i[2]}Pi(t){let i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];if(!i)throw"Zero-size vector!";i=Math.sqrt(i),t[0]/=i,t[1]/=i,t[2]/=i}Ti(t){let i=0;return Math.abs(t[1])>Math.abs(t[0])&&(i=1),Math.abs(t[2])>Math.abs(t[i])&&(i=2),i}Gi(t){let i,s,e,r,h,n,l=[0,0,0],a=[0,0,0],u=[0,0,0],o=[0,0,0],c=[0,0,0];const f=[null,null,null],v=[null,null,null],d=this.Kt.at;i=d.next;for(let t=0;t<3;++t)r=i.coords[t],a[t]=r,v[t]=i,l[t]=r,f[t]=i;for(i=d.next;i!==d;i=i.next)for(let t=0;t<3;++t)r=i.coords[t],r<a[t]&&(a[t]=r,v[t]=i),r>l[t]&&(l[t]=r,f[t]=i);let g=0;if(l[1]-a[1]>l[0]-a[0]&&(g=1),l[2]-a[2]>l[g]-a[g]&&(g=2),a[g]>=l[g])return t[0]=0,t[1]=0,void(t[2]=1);for(n=0,s=v[g],e=f[g],u[0]=s.coords[0]-e.coords[0],u[1]=s.coords[1]-e.coords[1],u[2]=s.coords[2]-e.coords[2],i=d.next;i!==d;i=i.next)o[0]=i.coords[0]-e.coords[0],o[1]=i.coords[1]-e.coords[1],o[2]=i.coords[2]-e.coords[2],c[0]=u[1]*o[2]-u[2]*o[1],c[1]=u[2]*o[0]-u[0]*o[2],c[2]=u[0]*o[1]-u[1]*o[0],h=c[0]*c[0]+c[1]*c[1]+c[2]*c[2],h>n&&(n=h,t[0]=c[0],t[1]=c[1],t[2]=c[2]);n<=0&&(t[0]=t[1]=t[2]=0,t[this.Ti(u)]=1)}zi(){var t,i,s=this.Kt.ut,e=this.Kt.at;let r=0;for(let t=s.next;t!==s;t=t.next)if(!((i=t.G).X<=0))do{r+=(i.L.m-i.O.m)*(i.L.R+i.O.R),i=i.H}while(i!==t.G);if(r<0){for(t=e.next;t!==e;t=t.next)t.R=-t.R;this.bi[0]=-this.bi[0],this.bi[1]=-this.bi[1],this.bi[2]=-this.bi[2]}}Bi(){let t,i,s=this.Kt.at,e=[0,0,0],r=!1;e[0]=this.Ni[0],e[1]=this.Ni[1],e[2]=this.Ni[2],e[0]||e[1]||e[2]||(this.Gi(e),r=!0),t=this.Si,i=this.bi;let h=this.Ti(e);t[h]=0,t[(h+1)%3]=1,t[(h+2)%3]=0,i[h]=0,i[(h+1)%3]=0,i[(h+2)%3]=e[h]>0?1:-1;for(let e=s.next;e!==s;e=e.next)e.m=this.Wi(e.coords,t),e.R=this.Wi(e.coords,i);r&&this.zi();let n=!0;for(let t=s.next;t!==s;t=t.next)n?(this.xi[0]=this.Ri[0]=t.m,this.xi[1]=this.Ri[1]=t.R,n=!1):(t.m<this.xi[0]&&(this.xi[0]=t.m),t.m>this.Ri[0]&&(this.Ri[0]=t.m),t.R<this.xi[1]&&(this.xi[1]=t.R),t.R>this.Ri[1]&&(this.Ri[1]=t.R))}qi(t,i){t.X+=i.X,t.Z.X+=i.Z.X}Ui(t,i){let s,e;if(s=i.G,s.H===s||s.H.H===s)throw"Mono region invalid";for(;r.D(s.O,s.L);s=s.it);for(;r.D(s.L,s.O);s=s.H);e=s.it;let h=void 0;for(;s.H!==e;)if(r.D(s.O,e.L)){for(;e.H!==s&&(r.k(e.H)||r.C(e.L,e.O,e.H.O)<=0);)h=t.connect(e.H,e),e=h.Z;e=e.it}else{for(;e.H!==s&&(r.F(s.it)||r.C(s.O,s.L,s.it.L)>=0);)h=t.connect(s,s.it),s=h.Z;s=s.H}if(e.H===s)throw"Mono region invalid";for(;e.H.H!==s;)h=t.connect(e.H,e),e=h.Z;return!0}Qi(t){let i;for(let s=t.ut.next;s!==t.ut;s=i)if(i=s.next,s.U&&!this.Ui(t,s))return!1;return!0}Yi(t){let i;for(let s=t.ut.next;s!==t.ut;s=i)i=s.next,s.U||t.Dt(s)}Zi(t,i,s){let e;for(let r=t.ot.next;r!==t.ot;r=e)e=r.next,r.$.U!==r.J.U?r.X=r.J.U?i:-i:s?t.delete(r):r.X=0}ji(t){return t.$&&t.$.U?t.$.n:-1}Hi(i,s,e,r){let h,n,l=0,a=0;e>3&&i.kt(e);for(let t=i.at.next;t!==i.at;t=t.next)t.n=-1;for(let t=i.ut.next;t!==i.ut;t=t.next)if(t.n=-1,t.U){h=t.G,n=0;do{let t=h.L;-1===t.n&&(t.n=a,a++),n++,h=h.H}while(h!==t.G);if(n>e)throw"Face vertex greater that support polygon";t.n=l,++l}this.Ai=l,s===t.o.g&&(l*=2),this.elements=[],this.elements.length=l*e,this.Vi=a,this.Ci=[],this.Ci.length=a*r,this.Ii=[],this.Ii.length=a;for(let t=i.at.next;t!==i.at;t=t.next)if(-1!==t.n){var u=t.n*r;this.Ci[u+0]=t.coords[0],this.Ci[u+1]=t.coords[1],r>2&&(this.Ci[u+2]=t.coords[2]),this.Ii[t.n]=t.lt}let o=0;for(let r=i.ut.next;r!==i.ut;r=r.next)if(r.U){h=r.G,n=0;do{let t=h.L;this.elements[o++]=t.n,n++,h=h.H}while(h!==r.G);for(let t=n;t<e;++t)this.elements[o++]=-1;if(s===t.o.g){h=r.G;do{this.elements[o++]=this.ji(h),h=h.H}while(h!==r.G);for(let t=n;t<e;++t)this.elements[o++]=-1}}}Ji(t,i){let s,e,r=0,h=0;this.Vi=0,this.Ai=0;for(let i=t.ut.next;i!==t.ut;i=i.next)if(i.U){e=s=i.G;do{this.Vi++,s=s.H}while(s!==e);this.Ai++}this.elements=[],this.elements.length=2*this.Ai,this.Ci=[],this.Ci.length=this.Vi*i,this.Ii=[],this.Ii.length=this.Vi;let n=0,l=0,a=0;r=0;for(let u=t.ut.next;u!==t.ut;u=u.next)if(u.U){h=0,e=s=u.G;do{this.Ci[n++]=s.L.coords[0],this.Ci[n++]=s.L.coords[1],i>2&&(this.Ci[n++]=s.L.coords[2]),this.Ii[l++]=s.L.lt,h++,s=s.H}while(s!==e);this.elements[a++]=r,this.elements[a++]=h,r+=h}}Ki(t,i){null===this.Kt&&(this.Kt=new a),t<2&&(t=2),t>3&&(t=3);let s=null;for(let e=0;e<i.length;e+=t)null===s?(s=this.Kt.Et(),this.Kt.splice(s,s.Z)):(this.Kt.xt(s),s=s.H),s.L.coords[0]=i[e+0],s.L.coords[1]=i[e+1],s.L.coords[2]=t>2?i[e+2]:0,s.L.lt=this.yi++,s.X=1,s.Z.X=-1}Xi(i=t.t.i,s=t.o.v,e,r,h,n=!0){if(this.Ci=[],this.elements=[],this.Ii=[],this.yi=0,h&&(this.Ni[0]=h[0],this.Ni[1]=h[1],this.Ni[2]=h[2]),this.si=i,r<2&&(r=2),r>3&&(r=3),!this.Kt)return!1;this.Bi(),g.Fi(this,n);var l=this.Kt;return s===t.o.p?this.Zi(l,1,!0):this.Qi(l),n&&l.Ot(),s===t.o.p?this.Ji(l,r):this.Hi(l,s,e,r),!0}}const p=t.t.i,_=t.t.s,E=t.t.h,m=t.t.l,R=t.t.u,x=t.o.v,D=t.o.g,M=t.o.p;return t.p=M,t.g=D,t.v=x,t.$i=w,t.ts=R,t.ss=m,t.es=_,t.rs=p,t.hs=E,t.Xi=function({si:i=t.t.i,ns:s=t.o.v,ls:e=3,as:r=2,Ni:h=[0,0,1],us:n=[],os:l=!0,debug:a=!1}){if(!n&&l)throw new Error("Contours can't be empty");if(!n)return;const u=new w;for(let t=0;t<n.length;t++)u.Ki(r||2,n[t]);return u.Xi(i,s,e,r,h,l),{Ci:u.Ci,Ii:u.Ii,Vi:u.Vi,elements:u.elements,Ai:u.Ai,Kt:a?u.Kt:void 0}},t}({});
